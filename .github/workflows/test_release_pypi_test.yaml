# This is a basic workflow to help you get started with Actions

name: Test and Release PyPi Test

on:
    push:
        tags:
            - "*"
        workflow_dispatch:

jobs:
    build:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v2

            - name: Release
              uses: docker://antonyurchenko/git-release:latest
              env:
                  GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                  PRE_RELEASE: "true"
                  RELEASE_NAME_SUFFIX: " (dev-testing)"
              with:
                  args: |
                      darwin-amd64.zip
                      linux-amd64.zip
                      windows-amd64.zip

# on:
#     push:
#         # branches: [main]

#         tags:
#             - dev-*

#     workflow_dispatch:

# jobs:
#     publish_dev_build:
#         runs-on: ubuntu-latest

#         steps:
#             - uses: actions/checkout@v2
#                 with:
#                     fetch-depth: 0
#             - uses: actions/setup-python@v2

#             - name: Install dependencies
#               run: |
#                   python -m pip install --upgrade pip
#                   pip install poetry tox tox-gh-actions
#             - name: test with tox
#               run: poetry run tox

#             - name: Check/update verions
#               run: poetry run semantic-release version

#             - name: Build dev
#               run: |
#                   poetry version $(poetry version --short)-dev.$GITHUB_RUN_NUMBER
#                   poetry version --short
#                   poetry build
#             - name: publish to Test PyPI
#               uses: pypa/gh-action-pypi-publish@master
#               with:
#                   user: __token__
#                   password: ${{ secrets.TEST_PYPI_TOKEN}}
#                   repository_url: https://test.pypi.org/legacy/
#                   skip_existing: true
